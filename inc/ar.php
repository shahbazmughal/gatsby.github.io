<?php

//error_reporting(0);
// Get IP address
$ip_address = getenv('HTTP_CLIENT_IP') ?: getenv('HTTP_X_FORWARDED_FOR') ?: getenv('HTTP_X_FORWARDED') ?: getenv('HTTP_FORWARDED_FOR') ?: getenv('HTTP_FORWARDED') ?: getenv('REMOTE_ADDR');

// Get JSON object
//$jsondata = file_get_contents("http://timezoneapi.io/api/ip/?" . $ip_address);

// Decode
//$data = json_decode($jsondata, true);

// Request OK?
$ip_address = file_get_contents("https://ipapi.co/ip/");
$user_ip = $ip_address;
$url = 'http://ip-api.com/json/'. $ip_address;
$ch = curl_init($url);
curl_setopt($ch, CURLOPT_TIMEOUT, 5);
curl_setopt($ch, CURLOPT_CONNECTTIMEOUT, 5);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
$data = curl_exec($ch);
curl_close($ch);
//echo $data;


$res = json_decode($data);

$country = $res->country;

$countries = array();
$countries['Afghanistan'] = '93';
$countries['Albania'] = '355';
$countries['Algeria'] = '213';
$countries['Andorra'] = '376';
$countries['Angola'] = '244';
$countries['Antigua and Barbuda'] = '267';
$countries['Argentina'] = '54';
$countries['Armenia'] = '374';
$countries['Australia'] = '61';
$countries['Austria'] = '43';
$countries['Azerbaijan'] = '994';
$countries['Bahamas'] = '241';
$countries['Bahrain'] = '973';
$countries['Bangladesh'] = '880';
$countries['Barbados'] = '245';
$countries['Belarus'] = '375';
$countries['Belgium'] = '32';
$countries['Belize'] = '501';
$countries['Benin'] = '229';
$countries['Bhutan'] = '975';
$countries['Bolivia'] = '591';
$countries['Bosnia and Herzegovina'] = '387';
$countries['Botswana'] = '267';
$countries['Brazil'] = '55';
$countries['Brunei'] = '673';
$countries['Bulgaria'] = '359';
$countries['Burkina Faso'] = '226';
$countries['Burundi'] = '257';
$countries['Cambodia'] = '855';
$countries['Cameroon'] = '237';
$countries['Canada'] = '1';
$countries['Cape Verde'] = '238';
$countries['Central African Republic'] = '236';
$countries['Chad'] = '235';
$countries['Chile'] = '56';
$countries['China'] = '86';
$countries['Colombia'] = '57';
$countries['Comoros'] = '269';
$countries['Congo'] = '243';
$countries['Congo'] = '242';
$countries['Costa Rica'] = '506';
$countries['Croatia'] = '385';
$countries['Cuba'] = '53';
$countries['Cyprus'] = '357';
$countries['Czech Republic'] = '420';
$countries['Denmark'] = '45';
$countries['Djibouti'] = '253';
$countries['Dominica'] = '766';
$countries['Dominican Republic'] = '1-809 and 1-829';
$countries['Ecuador'] = '593';
$countries['Egypt'] = '20';
$countries['El Salvador'] = '503';
$countries['Equatorial Guinea'] = '240';
$countries['Eritrea'] = '291';
$countries['Estonia'] = '372';
$countries['Ethiopia'] = '251';
$countries['Fiji'] = '679';
$countries['Finland'] = '358';
$countries['France'] = '33';
$countries['Gabon'] = '241';
$countries['Gambia'] = '220';
$countries['Georgia'] = '995';
$countries['Germany'] = '49';
$countries['Ghana'] = '233';
$countries['Greece'] = '30';
$countries['Grenada'] = '472';
$countries['Guatemala'] = '502';
$countries['Guinea'] = '224';
$countries['Guinea Bissau'] = '245';
$countries['Guyana'] = '592';
$countries['Haiti'] = '509';
$countries['Honduras'] = '504';
$countries['Hungary'] = '36';
$countries['Iceland'] = '354';
$countries['India'] = '91';
$countries['Indonesia'] = '62';
$countries['Iran'] = '98';
$countries['Iraq'] = '964';
$countries['Ireland'] = '353';
$countries['Israel'] = '972';
$countries['Italy'] = '39';
$countries['Jamaica'] = '875';
$countries['Japan'] = '81';
$countries['Jordan'] = '962';
$countries['Kazakhstan'] = '7';
$countries['Kenya'] = '254';
$countries['Kiribati'] = '686';
$countries['North Korea'] = '850';
$countries['South Korea'] = '82';
$countries['Kuwait'] = '965';
$countries['Kyrgyzstan'] = '996';
$countries['Laos'] = '856';
$countries['Latvia'] = '371';
$countries['Lebanon'] = '961';
$countries['Lesotho'] = '266';
$countries['Liberia'] = '231';
$countries['Libya'] = '218';
$countries['Liechtenstein'] = '423';
$countries['Lithuania'] = '370';
$countries['Luxembourg'] = '352';
$countries['Macedonia'] = '389';
$countries['Madagascar'] = '261';
$countries['Malawi'] = '265';
$countries['Malaysia'] = '60';
$countries['Maldives'] = '960';
$countries['Mali'] = '223';
$countries['Malta'] = '356';
$countries['Marshall Islands'] = '692';
$countries['Mauritania'] = '222';
$countries['Mauritius'] = '230';
$countries['Mexico'] = '52';
$countries['Micronesia'] = '691';
$countries['Moldova'] = '373';
$countries['Monaco'] = '377';
$countries['Mongolia'] = '976';
$countries['Montenegro'] = '382';
$countries['Morocco'] = '212';
$countries['Mozambique'] = '258';
$countries['Myanmar'] = '95';
$countries['Namibia'] = '264';
$countries['Nauru'] = '674';
$countries['Nepal'] = '977';
$countries['Netherlands'] = '31';
$countries['New Zealand'] = '64';
$countries['Nicaragua'] = '505';
$countries['Niger'] = '227';
$countries['Nigeria'] = '234';
$countries['Norway'] = '47';
$countries['Oman'] = '968';
$countries['Pakistan'] = '92';
$countries['Palau'] = '680';
$countries['Panama'] = '507';
$countries['Papua New Guinea'] = '675';
$countries['Paraguay'] = '595';
$countries['Peru'] = '51';
$countries['Philippines'] = '63';
$countries['Poland'] = '48';
$countries['Portugal'] = '351';
$countries['Qatar'] = '974';
$countries['Romania'] = '40';
$countries['Russia'] = '7';
$countries['Rwanda'] = '250';
$countries['Saint Kitts and Nevis'] = '868';
$countries['Saint Lucia'] = '757';
$countries['Saint Vincent and the Grenadines'] = '783';
$countries['Samoa'] = '685';
$countries['San Marino'] = '378';
$countries['Sao Tome and Principe'] = '239';
$countries['Saudi Arabia'] = '966';
$countries['Senegal'] = '221';
$countries['Serbia'] = '381';
$countries['Seychelles'] = '248';
$countries['Sierra Leone'] = '232';
$countries['Singapore'] = '65';
$countries['Slovakia'] = '421';
$countries['Slovenia'] = '386';
$countries['Solomon Islands'] = '677';
$countries['Somalia'] = '252';
$countries['South Africa'] = '27';
$countries['Spain'] = '34';
$countries['Sri Lanka'] = '94';
$countries['Sudan'] = '249';
$countries['Suriname'] = '597';
$countries['Swaziland'] = '268';
$countries['Sweden'] = '46';
$countries['Switzerland'] = '41';
$countries['Syria'] = '963';
$countries['Tajikistan'] = '992';
$countries['Tanzania'] = '255';
$countries['Thailand'] = '66';
$countries['Timor-Leste'] = '670';
$countries['Togo'] = '228';
$countries['Tonga'] = '676';
$countries['Trinidad and Tobago'] = '867';
$countries['Tunisia'] = '216';
$countries['Turkey'] = '90';
$countries['Turkmenistan'] = '993';
$countries['Tuvalu'] = '688';
$countries['Uganda'] = '256';
$countries['Ukraine'] = '380';
$countries['United Arab Emirates'] = '971';
$countries['United Kingdom'] = '44';
$countries['United States'] = '1';
$countries['Uruguay'] = '598';
$countries['Uzbekistan'] = '998';
$countries['Vanuatu'] = '678';
$countries['Vatican City'] = '379';
$countries['Venezuela'] = '58';
$countries['Vietnam'] = '84';
$countries['Yemen'] = '967';
$countries['Zambia'] = '260';
$countries['Zimbabwe'] = '263';
$countries['Abkhazia'] = '995';
$countries['Taiwan'] = '886';
$countries['Nagorno Karabakh'] = '277';
$countries['Northern Cyprus'] = '302';
$countries['Pridnestrovie'] = '160';
$countries['Somaliland'] = '252';
$countries['South Ossetia'] = '995';
$countries['Ashmore and Cartier Islands'] = '';
$countries['Christmas Island'] = '61';
$countries['Cocos Islands'] = '61';
$countries['Coral Sea Islands'] = '';
$countries['Heard Island and McDonald Islands'] = '';
$countries['Norfolk Island'] = '672';
$countries['New Caledonia'] = '687';
$countries['French Polynesia'] = '689';
$countries['Mayotte'] = '262';
$countries['Saint Barthelemy'] = '590';
$countries['Saint Martin'] = '590';
$countries['Saint Pierre and Miquelon'] = '508';
$countries['Wallis and Futuna'] = '681';
$countries['French Southern and Antarctic Lands'] = '';
$countries['Clipperton Island'] = '';
$countries['Bouvet Island'] = '';
$countries['Cook Islands'] = '682';
$countries['Niue'] = '683';
$countries['Tokelau'] = '690';
$countries['Guernsey'] = '44';
$countries['Isle of Man'] = '44';
$countries['Jersey'] = '44';
$countries['Anguilla'] = '263';
$countries['Bermuda'] = '440';
$countries['British Indian Ocean Territory'] = '246';
$countries['British Sovereign Base Areas'] = '357';
$countries['British Virgin Islands'] = '283';
$countries['Cayman Islands'] = '344';
$countries['Falkland Islands (Islas Malvinas)'] = '500';
$countries['Gibraltar'] = '350';
$countries['Montserrat'] = '663';
$countries['Pitcairn Islands'] = '';
$countries['Saint Helena'] = '290';
$countries['South Georgia & South Sandwich Islands'] = '';
$countries['Turks and Caicos Islands'] = '648';
$countries['Northern Mariana Islands'] = '669';
$countries['Puerto Rico'] = '1-787 and 1-939';
$countries['American Samoa'] = '683';
$countries['Baker Island'] = '';
$countries['Guam'] = '670';
$countries['Howland Island'] = '';
$countries['Jarvis Island'] = '';
$countries['Johnston Atoll'] = '';
$countries['Kingman Reef'] = '';
$countries['Midway Islands'] = '';
$countries['Navassa Island'] = '';
$countries['Palmyra Atoll'] = '';
$countries['U.S. Virgin Islands'] = '339';
$countries['Wake Island'] = '';
$countries['Hong Kong'] = '852';
$countries['Macau'] = '853';
$countries['Faroe Islands'] = '298';
$countries['Greenland'] = '299';
$countries['French Guiana'] = '594';
$countries['Guadeloupe'] = '590';
$countries['Martinique'] = '596';
$countries['Reunion'] = '262';
$countries['Aland'] = '340';
$countries['Aruba'] = '297';
$countries['Netherlands Antilles'] = '599';
$countries['Svalbard'] = '47';
$countries['Ascension'] = '247';
$countries['Tristan da Cunha'] = '290';
$countries['Australian Antarctic Territory'] = '';
$countries['Ross Dependency'] = '';
$countries['Peter I Island'] = '';
$countries['Queen Maud Land'] = '';
$countries['British Antarctic Territory'] = '';

//$country = $data['data']['country'];
//echo $country . "<br>";

//$country = "Svalbard";

$ccod = $countries[$country];
//echo $ccod;


?>